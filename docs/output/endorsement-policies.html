

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Endorsement policies &mdash; hyperledger-fabricdocs master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="hyperledger-fabricdocs master documentation" href="index.html"/>
        <link rel="next" title="Node SDK" href="nodesdk.html"/>
        <link rel="prev" title="Fabric CA User’s Guide" href="Setup/ca-setup.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          


          
            <a href="index.html" class="icon icon-home"> hyperledger-fabricdocs
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
<br>
<a href="https://chat.hyperledger.org">Rocket Chat</a>  <a href="https://jenkins.hyperledger.org/">CI</a>
<a href="http://stackoverflow.com/questions/tagged/hyperledger-fabric">StackOverflow</a>

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Get the Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release Notes</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_startedv2.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Key Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="capabilities.html">Fabric Capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="fabric_model.html">The Fabric Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="biz/usecases.html">Use Cases</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="demos.html">Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="chaincode.html">What is chaincode?</a></li>
<li class="toctree-l1"><a class="reference internal" href="videos.html">Videos</a></li>
</ul>
<p class="caption"><span class="caption-text">Operations Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="best_practices.html">Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="configtx.html">Channel Configuration (configtx)</a></li>
<li class="toctree-l1"><a class="reference internal" href="configtxgen.html">Configuring using the configtxgen tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="cc-packaging-and-signing.html">Chaincode Packaging and Signing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Setup/logging-control.html">Logging Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Architecture</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="arch-deep-dive.html">Architecture Explained</a></li>
<li class="toctree-l1"><a class="reference internal" href="txflow.html">Transaction Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="Setup/ca-setup.html">Fabric CA User’s Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Endorsement policies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#endorsement-policy-design">Endorsement policy design</a></li>
<li class="toctree-l2"><a class="reference internal" href="#endorsement-policy-syntax-in-the-cli">Endorsement policy syntax in the CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#specifying-endorsement-policies-for-a-chaincode">Specifying endorsement policies for a chaincode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#future-enhancements">Future enhancements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nodesdk.html">Node SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="orderingservice.html">Ordering Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="channels.html">Channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="ledger.html">Ledger</a></li>
<li class="toctree-l1"><a class="reference internal" href="readwrite.html">Read-Write set semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="gossip.html">Gossip data dissemination protocol</a></li>
</ul>
<p class="caption"><span class="caption-text">Troubleshooting and FAQs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ/architecture_FAQ.html">V1 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ/chaincode_FAQ.html">Chaincode (Smart Contracts and Digital Assets)</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ/identity_management_FAQ.html">Identity Management (Membership Service)</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l1"><a class="reference internal" href="MAINTAINERS.html">Maintainers</a></li>
<li class="toctree-l1"><a class="reference internal" href="jira_navigation.html">Using Jira to understand current work items</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup/devenv.html">Setting up the development environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup/build.html">Building the fabric</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup/build.html#building-outside-of-vagrant">Building outside of Vagrant</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup/build.html#configuration">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup/build.html#logging">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gerrit/lf-account.html">Requesting a Linux Foundation Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gerrit/gerrit.html">Working with Gerrit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gerrit/changes.html">Submitting a Change to Gerrit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gerrit/reviewing.html">Reviewing a Change</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gerrit/best-practices.html">Gerrit Recommended Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Style-guides/go-style.html">Coding guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="Style-guides/go-style.html#generating-grpc-code">Generating gRPC code</a></li>
<li class="toctree-l1"><a class="reference internal" href="Style-guides/go-style.html#adding-or-updating-go-packages">Adding or updating Go packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="questions.html">Still Have Questions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="quality.html">Quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">Status</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">hyperledger-fabricdocs</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Endorsement policies</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/endorsement-policies.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="endorsement-policies">
<h1>Endorsement policies<a class="headerlink" href="#endorsement-policies" title="Permalink to this headline">¶</a></h1>
<p>Endorsement policies are used to instruct a peer on how to decide
whether a transaction is properly endorsed. When a peer receives a
transaction, it invokes the VSCC (Validation System Chaincode)
associated with the transaction’s Chaincode as part of the transaction
validation flow to determine the validity of the transaction. Recall
that a transaction contains one or more endorsement from as many
endorsing peers. VSCC is tasked to make the following determinations: -
all endorsements are valid (i.e. they are valid signatures from valid
certificates over the expected message) - there is an appropriate number
of endorsements - endorsements come from the expected source(s)</p>
<p>Endorsement policies are a way of specifying the second and third
points.</p>
<div class="section" id="endorsement-policy-design">
<h2>Endorsement policy design<a class="headerlink" href="#endorsement-policy-design" title="Permalink to this headline">¶</a></h2>
<p>Endorsement policies have two main components: - a principal - a
threshold gate</p>
<p>A principal <code class="docutils literal"><span class="pre">P</span></code> identifies the entity whose signature is expected.</p>
<p>A threshold gate <code class="docutils literal"><span class="pre">T</span></code> takes two inputs: an integer <code class="docutils literal"><span class="pre">t</span></code> (the
threshold) and a list of <code class="docutils literal"><span class="pre">n</span></code> principals or gates; this gate
essentially captures the expectation that out of those <code class="docutils literal"><span class="pre">n</span></code> principals
or gates, <code class="docutils literal"><span class="pre">t</span></code> are requested to be satisfied.</p>
<p>For example: - <code class="docutils literal"><span class="pre">T(2,</span> <span class="pre">'A',</span> <span class="pre">'B',</span> <span class="pre">'C')</span></code> requests a signature from any 2
principals out of ‘A’, ‘B’ or ‘C’; - <code class="docutils literal"><span class="pre">T(1,</span> <span class="pre">'A',</span> <span class="pre">T(2,</span> <span class="pre">'B',</span> <span class="pre">'C'))</span></code>
requests either one signature from principal <code class="docutils literal"><span class="pre">A</span></code> or 1 signature from
<code class="docutils literal"><span class="pre">B</span></code> and <code class="docutils literal"><span class="pre">C</span></code> each.</p>
</div>
<div class="section" id="endorsement-policy-syntax-in-the-cli">
<h2>Endorsement policy syntax in the CLI<a class="headerlink" href="#endorsement-policy-syntax-in-the-cli" title="Permalink to this headline">¶</a></h2>
<p>In the CLI, a simple language is used to express policies in terms of
boolean expressions over principals.</p>
<p>A principal is described in terms of the MSP that is tasked to validate
the identity of the signer and of the role that the signer has within
that MSP. Currently, two roles are supported: <strong>member</strong> and <strong>admin</strong>.
Principals are described as <code class="docutils literal"><span class="pre">MSP</span></code>.<code class="docutils literal"><span class="pre">ROLE</span></code>, where <code class="docutils literal"><span class="pre">MSP</span></code> is the MSP
ID that is required, and <code class="docutils literal"><span class="pre">ROLE</span></code> is either one of the two strings
<code class="docutils literal"><span class="pre">member</span></code> and <code class="docutils literal"><span class="pre">admin</span></code>. Examples of valid principals are
<code class="docutils literal"><span class="pre">'Org0.admin'</span></code> (any administrator of the <code class="docutils literal"><span class="pre">Org0</span></code> MSP) or
<code class="docutils literal"><span class="pre">'Org1.member'</span></code> (any member of the <code class="docutils literal"><span class="pre">Org1</span></code> MSP).</p>
<p>The syntax of the language is:</p>
<p><code class="docutils literal"><span class="pre">EXPR(E[,</span> <span class="pre">E...])</span></code></p>
<p>where <code class="docutils literal"><span class="pre">EXPR</span></code> is either <code class="docutils literal"><span class="pre">AND</span></code> or <code class="docutils literal"><span class="pre">OR</span></code>, representing the two boolean
expressions and <code class="docutils literal"><span class="pre">E</span></code> is either a principal (with the syntax described
above) or another nested call to <code class="docutils literal"><span class="pre">EXPR</span></code>.</p>
<p>For example: - <code class="docutils literal"><span class="pre">AND('Org1.member',</span> <span class="pre">'Org2.member',</span> <span class="pre">'Org3.member')</span></code>
requests 1 signature from each of the three principals -
<code class="docutils literal"><span class="pre">OR('Org1.member',</span> <span class="pre">'Org2.member')</span></code> requests 1 signature from either
one of the two principals -
<code class="docutils literal"><span class="pre">OR('Org1.member',</span> <span class="pre">AND('Org2.member',</span> <span class="pre">'Org3.member'))</span></code> requests either
one signature from a member of the <code class="docutils literal"><span class="pre">Org1</span></code> MSP or 1 signature from a
member of the <code class="docutils literal"><span class="pre">Org2</span></code> MSP and 1 signature from a member of the <code class="docutils literal"><span class="pre">Org3</span></code>
MSP.</p>
</div>
<div class="section" id="specifying-endorsement-policies-for-a-chaincode">
<h2>Specifying endorsement policies for a chaincode<a class="headerlink" href="#specifying-endorsement-policies-for-a-chaincode" title="Permalink to this headline">¶</a></h2>
<p>Using this language, a chaincode deployer can request that the
endorsements for a chaincode be validated against the specified policy.
NOTE - the default policy requires one signature from a member of the
<code class="docutils literal"><span class="pre">DEFAULT</span></code> MSP). This is used if a policy is not specified in the CLI.</p>
<p>The policy can be specified at deploy time using the <code class="docutils literal"><span class="pre">-P</span></code> switch,
followed by the policy.</p>
<p>For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">peer</span> <span class="n">chaincode</span> <span class="n">deploy</span> <span class="o">-</span><span class="n">C</span> <span class="n">testchainid</span> <span class="o">-</span><span class="n">n</span> <span class="n">mycc</span> <span class="o">-</span><span class="n">p</span> <span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">chaincode</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">chaincode_example02</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;,&quot;100&quot;,&quot;b&quot;,&quot;200&quot;]}&#39;</span> <span class="o">-</span><span class="n">P</span> <span class="s2">&quot;AND(&#39;Org1.member&#39;, &#39;Org2.member&#39;)&quot;</span>
</pre></div>
</div>
<p>This command deploys chaincode <code class="docutils literal"><span class="pre">mycc</span></code> on chain <code class="docutils literal"><span class="pre">testchainid</span></code> with
the policy <code class="docutils literal"><span class="pre">AND('Org1.member',</span> <span class="pre">'Org2.member')</span></code>.</p>
</div>
<div class="section" id="future-enhancements">
<h2>Future enhancements<a class="headerlink" href="#future-enhancements" title="Permalink to this headline">¶</a></h2>
<p>In this section we list future enhancements for endorsement policies: -
alongside the existing way of identifying principals by their
relationship with an MSP, we plan to identify principals in terms of the
<em>Organization Unit (OU)</em> expected in their certificates; this is useful
to express policies where we request signatures from any identity
displaying a valid certificate with an OU matching the one requested in
the definition of the principal. - instead of the syntax <code class="docutils literal"><span class="pre">AND(.,</span> <span class="pre">.)</span></code>
we plan to move to a more intuitive syntax <code class="docutils literal"><span class="pre">.</span> <span class="pre">AND</span> <span class="pre">.</span></code> - we plan to
expose generalized threshold gates in the language as well alongside
<code class="docutils literal"><span class="pre">AND</span></code> (which is the special <code class="docutils literal"><span class="pre">n</span></code>-out-of-<code class="docutils literal"><span class="pre">n</span></code> gate) and <code class="docutils literal"><span class="pre">OR</span></code> (which
is the special <code class="docutils literal"><span class="pre">1</span></code>-out-of-<code class="docutils literal"><span class="pre">n</span></code> gate)</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="nodesdk.html" class="btn btn-neutral float-right" title="Node SDK" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Setup/ca-setup.html" class="btn btn-neutral" title="Fabric CA User’s Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, hyperledger.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'master',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>